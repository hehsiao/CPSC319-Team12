<h1 class="page-header">Reports</h1>


<section class="widget">
	<div class="panel-heading"><i class="fa fa-bar-chart-o"></i> Success Rate Report</div>
	<br>
	<div>The success rates for each staff member is calculated as the number of ideas in the final stage the staff member has been assigned, divided by the total number of ideas the staff member has been assigned</div>  
	<br>
	<div class="panel-body">
<!--
<table class="table table-hover dataTable" summary="User list">
	<thead>
		<tr class="header">
		  <th>Name</th>
		  <th>Email</th>
		  <th>Success Rate</th>
		</tr>
	</thead>
	
	<tbody>
		<% if @users %>
			<% index = 0 %>
			<% @users.each do |user| %>
			<tr onclick="document.location = '/reports/success_rate_show/<%=user.id%>';">
			  <td><%= user %></td>
			  <td><%= user.email %></td>
			  <td>
				<%= @success_rate_array.at(index) %>%
				<% index += 1 %>
			  </td>
			</tr>
			<% end %>
		<% end %>
	</tbody>
</table>
-->

<div style="width: 50%">
	<% index = 0 %>
	<% @users.each do |user| %>
	<div>
		<a href="/reports/success_rate_show/<%=user.id%>">
			<div>

				<%= user %>  (<%= user.email %>)
				<span class="pull-right text-muted"><%= @success_rate_array.at(index) %>% success rate</span>

				<div class="progress progress-striped active">
					<div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="<%= @success_rate_array.at(index) %>" aria-valuemin="0" aria-valuemax="100" style="width: <%= @success_rate_array.at(index) %>%">
						<span class="sr-only"><%= @success_rate_array.at(index) %>% Complete (success)</span>
					</div>
				</div>
			</div>
		</a>
	</div>
	<div class="divider"></div>
	<% index += 1 %>
	<% end %>
</div>

<!--<div id="chart_div" style="width: 700px; height: 500px;"></div>-->
</section>

<script>
  $(function () {
      new Morris.Bar({
        element: 'chart_div',
        data:[
					<% index = 0 %>
					<% @users.each do |user| %>
			      {user: "<%= user %>", rate: <%= @success_rate_array.at(index) %> },
						<% index += 1 %>
	        <% end %>
        ],
        xkey: 'user',
        ykeys: ['rate'],
        labels: ['Total'],
        xLabels: ['users'],
        resize: true,
        gridTextColor: '#FFF',
        gridTextFamily: '"Open Sans", sans-serif'
      });

  });
</script>
