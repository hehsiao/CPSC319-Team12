<h1 class="page-header">Reports</h1>

<section class="widget">
	<div class="panel-heading"><i class="fa fa-bar-chart-o"></i> Success Rate Report</div>
	  
	<div class="panel-body">

<table class="table table-hover dataTable" summary="User list">
	<thead>
		<tr class="header">
		  <th>Name</th>
		  <th>Email</th>
		  <th>Success Rate</th>
		</tr>
	</thead>
	
	<tbody>
		<% if @users %>
			<% index = 0 %>
			<% @users.each do |user| %>
			<tr onclick="document.location = '/reports/success_rate_show/<%=user.id%>';">
			  <td><%= user %></td>
			  <td><%= user.email %></td>
			  <td>
				<%= @success_rate_array.at(index) %>%
				<% index += 1 %>
			  </td>
			</tr>
			<% end %>
		<% end %>
	</tbody>
</table>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
google.load("visualization", "1", {packages:["corechart"]});
google.setOnLoadCallback(drawChart);
function drawChart() {
var data = google.visualization.arrayToDataTable([
	['User', 'Success Rate (%)'],
	<% index = 0 %>
	<% @users.each do |user| %>
		["<%= user %>", <%= @success_rate_array.at(index) %>],
		<% index += 1 %>
	<% end %>
]);

var options = {
  title: 'Success Rate',
  hAxis: {title: 'Users', titleTextStyle: {color: 'red'}}
};

var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
chart.draw(data, options);
}
</script>

<div id="chart_div" style="width: 700px; height: 500px;"></div>
</section>

